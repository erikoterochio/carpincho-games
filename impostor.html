<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>El Impostor · Carpincho Games</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <style>
    :root {
      --bg: #0A092C;
      --pink: #FF6B6B;
      --blue: #335C81;
      --indigo: #1B2845;
      --sky: #5899E2;
      --card: #ffffff;
      --text: #1B2845;
      --muted: #6b7280;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      background: var(--bg);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .app {
      width: 100%;
      max-width: 480px;
      background: var(--card);
      border-radius: 18px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(0, 0, 0, 0.03);
      padding: 14px 14px 12px;
      border: 1px solid rgba(27, 40, 69, 0.1);
    }

    .screen {
      display: none;
    }

    .screen.active {
      display: block;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 12px;
    }

    .title-group h1 {
      font-size: 1.35rem;
      font-weight: 700;
      color: var(--indigo);
    }

    .back-link {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--indigo);
      text-decoration: none;
      border-radius: 999px;
      border: 1px solid rgba(51, 92, 129, 0.3);
      padding: 6px 14px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #ffffff;
      white-space: nowrap;
    }

    .back-link:hover {
      background: #f9f9f9;
      border-color: var(--blue);
    }

    .content {
      background: #f8f9fa;
      border-radius: 16px;
      padding: 20px 16px;
      border: 1px solid rgba(148, 163, 184, 0.3);
    }

    .intro-text {
      font-size: 0.9rem;
      line-height: 1.6;
      color: var(--text);
      margin-bottom: 20px;
    }

    .btn {
      width: 100%;
      padding: 14px 20px;
      border-radius: 12px;
      border: none;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s ease;
      touch-action: manipulation;
    }

    .btn-primary {
      background: var(--sky);
      color: #ffffff;
      border: 2px solid var(--sky);
    }

    .btn-primary:hover {
      background: #4a8dd4;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(88, 153, 226, 0.3);
    }

    .btn-secondary {
      background: #ffffff;
      color: var(--indigo);
      border: 2px solid rgba(51, 92, 129, 0.3);
    }

    .btn-secondary:hover {
      background: #f9f9f9;
      border-color: var(--blue);
    }

    .btn:active {
      transform: scale(0.98);
    }

    .btn-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .instructions {
      font-size: 0.9rem;
      line-height: 1.6;
      color: var(--text);
    }

    .instructions h3 {
      font-size: 1.05rem;
      margin-top: 16px;
      margin-bottom: 8px;
      color: var(--sky);
    }

    .instructions p {
      margin-bottom: 12px;
    }

    .step-list {
      list-style: none;
      padding: 0;
      margin-bottom: 12px;
    }

    .step-list li {
      display: flex;
      gap: 12px;
      margin-bottom: 10px;
      align-items: flex-start;
    }

    .step-number {
      min-width: 24px;
      font-weight: 700;
      color: var(--sky);
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--indigo);
      margin-bottom: 8px;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px 14px;
      border: 2px solid rgba(148, 163, 184, 0.3);
      border-radius: 10px;
      font-size: 1rem;
      background: #ffffff;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--sky);
    }

    .player-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .inline-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .info-text {
      font-size: 1.15rem;
      line-height: 1.6;
      text-align: center;
      color: var(--text);
      margin-bottom: 20px;
    }

    .info-text.large {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--indigo);
    }

    .word-card {
      background: #ffffff;
      border-radius: 12px;
      padding: 32px 24px;
      text-align: center;
      border: 3px solid var(--sky);
      margin: 20px 0;
    }

    .word-card.impostor {
      border-color: var(--pink);
    }

    .secret-word {
      font-size: 2.2rem;
      font-weight: 700;
      color: var(--indigo);
      margin: 16px 0;
    }

    .secret-word.impostor {
      color: var(--pink);
    }

    .player-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 16px 0;
    }

    .player-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      background: #ffffff;
      border-radius: 10px;
      border: 2px solid rgba(148, 163, 184, 0.3);
    }

    .player-item.active {
      border-color: var(--sky);
      background: #e0f2fe;
    }

    .player-item.eliminated {
      opacity: 0.5;
      text-decoration: line-through;
    }

    .player-name {
      font-size: 1rem;
      font-weight: 600;
      color: var(--indigo);
    }

    .timer {
      font-size: 3rem;
      font-weight: 700;
      text-align: center;
      color: var(--pink);
      margin: 24px 0;
      font-variant-numeric: tabular-nums;
    }

    .vote-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin: 20px 0;
    }

    .vote-btn {
      padding: 16px;
      background: #ffffff;
      border: 2px solid rgba(148, 163, 184, 0.3);
      border-radius: 10px;
      font-size: 1.05rem;
      font-weight: 600;
      color: var(--indigo);
      cursor: pointer;
      transition: all 0.15s ease;
      text-align: left;
    }

    .vote-btn:hover {
      border-color: var(--sky);
      background: #e0f2fe;
      transform: translateX(4px);
    }

    .vote-btn:active {
      transform: scale(0.98);
    }

    .scoreboard {
      margin: 20px 0;
    }

    .score-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: #ffffff;
      border-radius: 10px;
      margin-bottom: 8px;
      border: 2px solid rgba(148, 163, 184, 0.3);
    }

    .score-item.winner {
      border-color: var(--sky);
      background: #e0f2fe;
    }

    .score-name {
      font-size: 1rem;
      font-weight: 600;
      color: var(--indigo);
    }

    .score-points {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--sky);
    }

    .result-box {
      background: #ffffff;
      border-radius: 12px;
      padding: 24px 20px;
      text-align: center;
      margin: 20px 0;
      border: 3px solid var(--sky);
    }

    .result-box.impostor {
      border-color: var(--pink);
    }

    .result-box h3 {
      font-size: 1.1rem;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .result-box .big-text {
      font-size: 1.6rem;
      font-weight: 700;
      color: var(--indigo);
      margin: 8px 0;
    }

    .result-box .role-text {
      font-size: 1.3rem;
      font-weight: 700;
      margin-top: 8px;
    }

    .role-text.citizen {
      color: var(--sky);
    }

    .role-text.impostor {
      color: var(--pink);
    }

    .round-indicator {
      font-size: 0.85rem;
      color: var(--muted);
      text-align: center;
      margin-bottom: 12px;
    }

    footer {
      margin-top: 12px;
      font-size: 0.75rem;
      color: var(--muted);
      text-align: center;
    }

    .floating-home {
      position: fixed;
      top: 16px;
      right: 16px;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #ffffff;
      text-decoration: none;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      padding: 6px 14px;
      background: rgba(27, 40, 69, 0.9);
      backdrop-filter: blur(10px);
      z-index: 1000;
      transition: all 0.15s ease;
    }
    
    .floating-home:hover {
      background: rgba(27, 40, 69, 1);
      border-color: rgba(255, 255, 255, 0.5);
      transform: translateY(-1px);
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }

      .app {
        padding: 12px 10px 10px;
      }
    }
  </style>
</head>
<body>
  <a href="index.html" class="floating-home">← Inicio</a>
  <main class="app">
    <!-- PANTALLA 1: INICIO -->
    <div class="screen active" id="screen-home">
      <header>
        <div class="title-group">
          <h1>El Impostor</h1>
        </div>
        <!-- <a href="index.html" class="back-link">← Inicio</a> -->
      </header>

      <div class="content">
        <p class="intro-text">
          Usen un solo celular.<br>
          La app se ocupa de la palabra, los roles, el orden y la votación.
        </p>
        
        <div class="btn-group">
          <button class="btn btn-secondary" onclick="showScreen('screen-instructions')">Cómo se juega</button>
          <button class="btn btn-primary" onclick="showScreen('screen-setup')">Jugar</button>
        </div>
      </div>
    </div>

    <!-- PANTALLA 2: INSTRUCCIONES -->
    <div class="screen" id="screen-instructions">
      <header>
        <div class="title-group">
          <h1>Cómo se juega</h1>
        </div>
        <button class="back-link" onclick="showScreen('screen-home')" style="border:none;background:transparent;cursor:pointer;">← Volver</button>
      </header>

      <div class="content">
        <div class="instructions">
          <p>Uno o más jugadores son impostores y no conocen la palabra secreta. Todos dan pistas en voz alta y luego votan quién creen que miente.</p>
          
          <ul class="step-list">
            <li>
              <span class="step-number">1.</span>
              <span>Configuran jugadores, impostores, categoría y número de rondas.</span>
            </li>
            <li>
              <span class="step-number">2.</span>
              <span>El celular se pasa y cada uno ve su palabra (o descubre que es impostor).</span>
            </li>
            <li>
              <span class="step-number">3.</span>
              <span>Todos dan una pista en voz alta, en orden.</span>
            </li>
            <li>
              <span class="step-number">4.</span>
              <span>Discusión con tiempo limitado.</span>
            </li>
            <li>
              <span class="step-number">5.</span>
              <span>Votación abierta para eliminar a un jugador.</span>
            </li>
            <li>
              <span class="step-number">6.</span>
              <span>El juego termina cuando eliminan a todos los impostores o se acaban las rondas configuradas.</span>
            </li>
          </ul>
        </div>
        
        <div class="btn-group">
          <button class="btn btn-primary" onclick="showScreen('screen-home')">Entendido</button>
        </div>
      </div>
    </div>

    <!-- PANTALLA 3: CONFIGURACIÓN -->
    <div class="screen" id="screen-setup">
      <header>
        <div class="title-group">
          <h1>Configurar Partida</h1>
        </div>
        <button class="back-link" onclick="showScreen('screen-home')" style="border:none;background:transparent;cursor:pointer;">← Volver</button>
      </header>

      <div class="content">
        <form id="setup-form" onsubmit="startGame(event)">
          <div class="inline-group">
            <div class="form-group">
              <label>Jugadores</label>
              <select id="player-count" onchange="updatePlayerInputs()">
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5" selected>5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
              </select>
            </div>

            <div class="form-group">
              <label>Impostores</label>
              <select id="impostor-count">
                <option value="1" selected>1</option>
                <option value="2">2</option>
                <option value="3">3</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>Nombres de jugadores</label>
            <div class="player-inputs" id="player-names-container"></div>
          </div>

          <div class="form-group">
            <label>Categoría de palabra</label>
            <select id="word-category">
              <option value="aleatoria" selected>Aleatoria</option>
              <option value="deportes">Deportes</option>
              <option value="peliculasSeries">Películas y Series</option>
              <option value="objetos">Objetos</option>
              <option value="lugares">Lugares</option>
              <option value="personalidades">Personalidades</option>
              <option value="cocina">Cocina</option>
              <option value="animales">Animales</option>
              <option value="musica">Música</option>
              <option value="tecnologia">Tecnología</option>
            </select>
          </div>

          <div class="inline-group">
            <div class="form-group">
              <label>Rondas máximas</label>
              <select id="max-rounds">
                <option value="1">1 ronda</option>
                <option value="2">2 rondas</option>
                <option value="3" selected>3 rondas</option>
                <option value="4">4 rondas</option>
                <option value="5">5 rondas</option>
              </select>
            </div>

            <div class="form-group">
              <label>Tiempo votación</label>
              <select id="vote-time">
                <option value="30">30 seg</option>
                <option value="60" selected>1 min</option>
                <option value="90">1:30 min</option>
                <option value="120">2 min</option>
              </select>
            </div>
          </div>

          <div class="btn-group">
            <button type="submit" class="btn btn-primary">Empezar Partida</button>
          </div>
        </form>
      </div>
    </div>

    <!-- PANTALLA 4: PASAR CELULAR PARA VER PALABRA -->
    <div class="screen" id="screen-pass-phone">
      <header>
        <div class="title-group">
          <h1>Revelar Palabra</h1>
        </div>
      </header>

      <div class="content">
        <p class="round-indicator" id="round-indicator-pass"></p>
        <p class="info-text large" id="pass-phone-text">Pasá el celular a [Jugador]</p>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="showWord()">Mostrar palabra</button>
        </div>
      </div>
    </div>

    <!-- PANTALLA 5: MOSTRAR PALABRA/IMPOSTOR -->
    <div class="screen" id="screen-show-word">
      <header>
        <div class="title-group">
          <h1 id="word-header">Tu Palabra</h1>
        </div>
      </header>

      <div class="content">
        <div class="word-card" id="word-card">
          <div class="secret-word" id="word-display"></div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="nextPlayerWord()">Listo, siguiente jugador</button>
        </div>
      </div>
    </div>

    <!-- PANTALLA 6: INICIAR RONDA DE PISTAS -->
    <div class="screen" id="screen-start-clues">
      <header>
        <div class="title-group">
          <h1>Iniciar Pistas</h1>
        </div>
      </header>

      <div class="content">
        <p class="round-indicator" id="round-indicator-clues"></p>
        <p class="info-text">Todos recibieron su palabra (o descubrieron que son impostores).</p>
        <p class="info-text" style="font-size:1rem;color:var(--sky);font-weight:600;">Categoría: <span id="category-display"></span></p>
        <p class="info-text">Empieza <strong id="first-player-name" style="color:var(--sky);"></strong> dando una pista en voz alta.</p>
        <p class="info-text" style="font-size:0.95rem;color:var(--muted);">El resto continúa en orden hacia la derecha.</p>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="startClueTracking()">Iniciar ronda de pistas</button>
        </div>
      </div>
    </div>

    <!-- PANTALLA 7: SEGUIMIENTO DE PISTAS -->
    <div class="screen" id="screen-clues">
      <header>
        <div class="title-group">
          <h1>Dar Pistas</h1>
        </div>
      </header>

      <div class="content">
        <p class="round-indicator" id="round-indicator-tracking"></p>
        <p class="info-text">Turno de: <strong id="current-clue-player" style="color:var(--sky);">Jugador</strong></p>
        
        <div class="player-list" id="clue-player-list"></div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="nextClue()">Siguiente</button>
        </div>
      </div>
    </div>

    <!-- PANTALLA 8: VOTACIÓN CON TIMER -->
    <div class="screen" id="screen-vote-timer">
      <header>
        <div class="title-group">
          <h1>Discusión</h1>
        </div>
      </header>

      <div class="content">
        <p class="round-indicator" id="round-indicator-discussion"></p>
        <p class="info-text">Discutan quién creen que es el impostor</p>

        <div class="timer" id="vote-timer">01:00</div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="skipToVote()">Ir a votación</button>
        </div>
      </div>
    </div>

    <!-- PANTALLA 9: VOTACIÓN ABIERTA -->
    <div class="screen" id="screen-vote">
      <header>
        <div class="title-group">
          <h1>Votación</h1>
        </div>
      </header>

      <div class="content">
        <p class="round-indicator" id="round-indicator-vote"></p>
        <p class="info-text">¿Quién fue el elegido por el grupo?</p>

        <div class="vote-grid" id="vote-buttons"></div>
      </div>
    </div>

    <!-- PANTALLA 10: RESULTADO DE VOTACIÓN -->
    <div class="screen" id="screen-vote-result">
      <header>
        <div class="title-group">
          <h1>Resultado</h1>
        </div>
      </header>

      <div class="content">
        <p class="round-indicator" id="round-indicator-result"></p>
        <div class="result-box" id="result-box">
          <h3>Eliminado:</h3>
          <div class="big-text" id="eliminated-player-name">Jugador</div>
          <div class="role-text" id="eliminated-player-role">CIUDADANO</div>
        </div>

        <p class="info-text" id="game-status-text" style="font-size:1rem;"></p>

        <div class="btn-group" id="result-buttons"></div>
      </div>
    </div>

    <!-- PANTALLA 11: FIN DE RONDA -->
    <div class="screen" id="screen-end-round">
      <header>
        <div class="title-group">
          <h1>Ronda Terminada</h1>
        </div>
      </header>

      <div class="content">
        <div class="result-box">
          <h3 id="round-winner-text">Ganaron los Ciudadanos</h3>
          <p style="margin-top:12px;font-size:0.95rem;color:var(--muted);" id="round-summary"></p>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="showPlayAgainOptions()">Jugar otra ronda</button>
        </div>
      </div>
    </div>

    <!-- PANTALLA 12: OPCIONES PARA JUGAR DE NUEVO -->
    <div class="screen" id="screen-play-again">
      <header>
        <div class="title-group">
          <h1>Nueva Ronda</h1>
        </div>
      </header>

      <div class="content">
        <p class="info-text">¿Qué querés hacer?</p>

        <div class="btn-group">
          <button class="btn btn-primary" onclick="repeatAll()">Repetir todo igual</button>
          <button class="btn btn-secondary" onclick="changeCategory()">Cambiar solo categoría</button>
          <button class="btn btn-secondary" onclick="changeConfig()">Cambiar configuración</button>
        </div>
      </div>
    </div>

    <footer>
      <span>Carpincho Games · El Impostor</span>
    </footer>
  </main>

  <script>
    // Estado del juego
    const gameState = {
      players: [],
      eliminated: [],
      impostorCount: 1,
      wordCategory: 'aleatoria',
      currentCategory: '',
      word: '',
      roles: [],
      impostorIndexes: [],
      currentPlayerIndex: 0,
      maxRounds: 3,
      currentRound: 0,
      voteTime: 60,
      firstPlayerIndex: 0,
      initialFirstPlayer: 0
    };

    // Diccionario de palabras
    const wordBank = { 
      deportes: ['River Plate','Yoga','Crossfit','Gimnasio','Pilates','Jabalina','Boca Juniors','Selección Argentina','La Scaloneta','Lionel Messi','Diego Maradona','Ángel Di María','Juan Román Riquelme','Marcelo Gallardo','Carlos Tevez','Racing Club','Independiente','San Lorenzo','Newells','Rosario Central','Banfield','Lanus','Barracas Central','Riestra','Peñarol','Nacional','Gustavo Alfaro','Carlos Bianchi','Sir Alex Ferguson','Rafael Nadal','Gato Gaudio','Agustín Pichot','Los Pumas','Manu Ginóbili','Michael Jordan','Roger Federer','Copa Libertadores','Champions League','Chiqui Tapia','Caruso Lombardi','Cristiano Ronaldo','Neymar','Ronaldinho','Ronaldo Nazário','Carlos Bilardo','Pupi Zanetti','Chilavert','Ogro Fabbiani','Kobe Bryant','La Bombonera','Camp Nou','Pádel','Fútbol','Tenis','Basquet','Ping Pong','Polo','Bowling','Golazo','Árbitro','Coneja Baldassi','Zinedine Zidane','Walter Safarian','Pollo Vignolo','Mariano Closs','Franco Colapinto','F1','Lewis Hamilton','Max Verstappen','JM Fangio','Esteroides','Raqueta','Red','Estadio','Copa','Golf','Diego Latorre','JJ.OO.','Doping','Chipi Barijho','Wanchope Ábila' ], 
      peliculasSeries: ['El secreto de sus ojos','Relatos salvajes','Nueve Reinas','Casados con hijos','Los simuladores','Okupas','El Marginal','La Casa de Papel','Breaking Bad','Game of Thrones','Friends','The Office','Stranger Things','Titanic','El Padrino','Star Wars','Harry Potter','Toy Story','Shrek','Merlí','Spiderman','Los Simuladores','Blancanieves','History Channel','Los Simpsons','El chavo del 8','Alien','Terminator','Depredador','Scooby Doo','Matrix','Forrest Gump','Jumanji','El rey león','Volver al futuro','E.T.','James Bond','Hulk','Superman','Batman','Mi pobre angelito','El señor de los anillos','Telefé','Canal 13','ESPN','MTV','Dumbo','Dragon Ball','El Padrino'], 
      objetos: ['Celular','Computadora','Notebook','Televisor','Controles remoto','Auriculares','Libro','Lapicera','Llave','Gafas de sol','Mochila','Billetera','Reloj','Cargador','Botella de agua','Paraguas','Cámara de fotos','Silla','Mesa','Espejo','Disco','Mesa','Auto','Moto','Dildo','Olla','Pala','Billete','Sobre','Paragüas','Puerta','Pelota','Parrilla','Remera','Alfombra','Bandera','Control remoto','Vaso','Piedra','Tijera','Libro','Planta','Maceta','Cartas','Vaso Stanley','Heladera','Gorra','Cama','Semáforo','Micrófono','Radio','Televisor','Computadora','Zapatillas','Silla','Celular','Aspiradora','Collar','Picador','Correa','Alfombra','Candado'], 
      lugares: ['Buenos Aires','Obelisco','La Bombonera','El Monumental','Mar del Plata','Bariloche','Mendoza','Cataratas del Iguazú','La Patagonia','Córdoba','Rosario','Palermo','Recoleta','París','Roma','Madrid','Nueva York','Tokio','Playa','Montaña','Ranchos','Brandsen','CABA','Mar del Plata','Jamaica','Cuba','Uruguay','Montevideo','Asunción','Paraguay','Bolivia','Chile','Brasil','Rio de Janeiro','Italia','Roma','Milán','Madrid','Barcelona','España','Portugal','Islas Malvinas','Antártida','Asia','Japón','China','La luna','Marte','Abril','El Carmen','Greenville','EEUU','Miami','Canadá','México','Cancún','Sudáfrica','Australia','Segurola y La Habana','Microcentro','Pilar','Luján','Charita','La Boca','Angola','Escocia','Finlandia','Antártida','Berlín','Caribe','Sahara','Egipto','Himalayas','Perú','Machu Pichu','Lejos','Lo de kevito','La reja','Costanera','Puerto Madero','Alemania','Venezuela','Caracas','Grecia','Mykonos','Croacia','La Matanza','Villa 31','Barrio Marítimo','Formosa','Qatar','Pampa y la vía','Quilmes oeste','Pinamar','Cariló'], 
      personalidades: ['Lionel Messi','Diego Maradona','Ricardo Darín','Susana Giménez','Mirtha Legrand','Gustavo Cerati','Charly García','Fito Páez','Tini Stoessel','Bizarrap','Duki','Papa Francisco','Jorge Luis Borges','Shakira','Bad Bunny','Michael Jackson','Barack Obama','Cristina Fernández de Kirchner','Mauricio Macri','Javier Milei','Elon Musk','Donald Trump','Alberto Fernandez','Mario','Lucre','Benja','Kevito','La Garza','El Rifle','Kike Feldman','Nicolas Occhiato','Miguel Granados','Sebastián Wanraich','Guillermo Francella','Ricardo Darín','Caruso Lombardi','Diego Maradona','Chiqui Tapia','Marcelo Polino','Marcelo Tinelli','Mario Pergolini','Steve Jobs','San Martín','Hitler','Vladimir Putin','Pablo Escobar','Pablo Lescano','Mahatma Gandhi','Cleopatra','Freddie Mercury','Shakira','Jorge Rial','Kun Agüero','Guido Kaczka','JM Fangio','Franco Colapinto','Poli Calello','Justin Bieber','Usain Bolt','Natacha Jaitt','Alberto Nisman','Jorge Andri','Florencia de la V','Marcos Galperín','Hugo Moyano','Horacio R. Larreta','Pato Bullrich','Axel Kicillof','Perón','René Favaloro','Marley','Bob Marley','Adrián Suar','JM Listorti','Larry de Clay','Andrés Calamaro','Diego Latorre','Albert Einstein','Ibai','Davoo Xeneixe','Mr Beast','Lamine Yamal','Dibu Martinez','Sasha Gery','La Roca','Vin Diesel','Jordi el niño polla','LeBron James','El Bananero','Marito Baracus','Jeff Epstein','Osama Bin Laden','Julio Grondona','El mago sin dientes','Napoleón'], 
      cocina: ['Asado','Empanadas','Milanesa','Pizza','Fideos con tuco','Ñoquis','Locro','Choripán','Hamburguesa','Ensalada rusa','Helado','Torta','Dulce de leche','Mate','Café','Fernet con coca','Cerveza','Sushi','Cuchillo','Tenedor','Sartén','Heladera','Tequila','Olla','Parrilla','Sartén','Cuchara','Hornalla','Vaso Stanley','Lasagna','Milanesa','Huevo frito','Papa frita','Shawarma','Pescado','Ribs','Pollo','Vermut','Gin tonic','Soda','Pava','Bandeja','Horno','Microondas','Chef','Sopa','Pastelería','Panadería','Pan','Sanguche','Tostado','Café','Leche','Naranja','Banana','Tomate','Lechuga','Cebolla','Pomelo','Menta','Azúcar','Freezer','Restaurant','Bar','Cocktail','Trago','Postre','Desayuno','Almuerzo','Cena','Chocolate','Golosina','Caramelo','Chupetín','Miel','Mate','Jamón','Queso','Albóndiga'], 
      animales: ['Perro','Gato','Carpincho','Loro','Caballo','Vaca','Oveja','Cerdo','Gallina','Pato','León','Tigre','Elefante','Jirafa','Mono','Pez','Delfín','Ballena','Tortuga','Ratón','Ardilla','Garza','Oso','Jirafa','Buitre','Koala','Cordero','Hormiga','Langosta','Cangrejo','Puma','Águila','Cóndor','Escarabajo','Cobra','Serpiente','Rinoceronte','Flamenco','Tigre','Iguana','Sabueso','Oca','Morsa','Foca','Cabra','Anguila','Mono','Gorila','Lobo','Leopardo','Yacaré','Piojo','Víbora','Alacrán','Escorpión','Cucaracha','Mosca','Mosquito','Tarántula','Liebre','Tiranosaurio','Tiburón','Ballena','Calamar','Estrella de mar','Pepino de mar','Dragón','Unicornio','Burro','Jabalí','Orangután','Pelicano','Tucán','Cuervo','Lagartija','Lagarto','Libélula','Pato','Ganso','Nutria'], 
      musica: ['Rock nacional','Cumbia','Cuarteto','Tango','Reggaetón','Trap','Pop','Soda Stereo','Los Redondos','La Renga','Ciro y Los Persas','Los Auténticos Decadentes','Los Palmeras','Lali Espósito','Abel Pintos','Coldplay','Queen','The Beatles','Bad Bunny','Bizarrap','Rolling Stones','U2','Pibes Chorros','Los Piojos','La Renga','Radio Aspen','David Guetta','Los Redondos','Miranda','Airbag','Bono','Pappo','Coldplay','Ed Sheeran','Duki','Paulo Londra','Gustavo Cerati','Indio Solari','Andrés Calamaro','Javier Calamaro','Red Hot Chilli Peppers','Nirvana','Kurt Cobain','La Sole','Luck ra','La mona gimenez','Kapanga','Molotov','Alberto Spinetta','El plan de la mariposa','Los cafres','Autenticos Decadentes','Chano','Babasónicos','Michael Jackson','Shakira','Madonna','Britney Spears','Carlos Gardel','Eros Ramazzoti','Reggae','Ópera','Folclore','Cumbia','Tango','Rap','Sumo','Rata Blanca','Los Pimpinela'], 
      tecnologia: ['WhatsApp','Instagram','TikTok','Netflix','Spotify','YouTube','Google','Correo electrónico','WiFi','Bluetooth','Notebook','Tablet','Smart TV','Consola de videojuegos','PlayStation','Xbox','Mouse','Teclado','Pendrive','Nube','Criptomoneda','Hacker','Bitcoin','Ethereum','Internet','Nintendo','Gameboy','Atari','Láser','Iphone','Android','Robot','ChatGPT','Radio','Televisor','Radar','Satélite','Wifi','Wikipedia','Fibertel','Click','Excel','Mail','Videojuego','Sitio web']
    };

    let voteTimer = null;
    const STORAGE_KEY = 'impostor_config';
    const STORAGE_EXPIRY = 2 * 60 * 60 * 1000;

    // Navegación entre pantallas
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
    }

    // Actualizar indicadores de ronda
    function updateRoundIndicators() {
      const text = `Ronda ${gameState.currentRound} de ${gameState.maxRounds}`;
      document.getElementById('round-indicator-pass').textContent = text;
      document.getElementById('round-indicator-clues').textContent = text;
      document.getElementById('round-indicator-tracking').textContent = text;
      document.getElementById('round-indicator-discussion').textContent = text;
      document.getElementById('round-indicator-vote').textContent = text;
      document.getElementById('round-indicator-result').textContent = text;
    }

    // Guardar configuración
    function saveConfig() {
      const config = {
        playerCount: document.getElementById('player-count').value,
        impostorCount: document.getElementById('impostor-count').value,
        wordCategory: document.getElementById('word-category').value,
        maxRounds: document.getElementById('max-rounds').value,
        voteTime: document.getElementById('vote-time').value,
        timestamp: Date.now()
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(config));
    }

    // Cargar configuración
    function loadConfig() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (!saved) return;
      
      try {
        const config = JSON.parse(saved);
        if (Date.now() - config.timestamp > STORAGE_EXPIRY) {
          localStorage.removeItem(STORAGE_KEY);
          return;
        }
        
        document.getElementById('player-count').value = config.playerCount;
        document.getElementById('impostor-count').value = config.impostorCount;
        document.getElementById('word-category').value = config.wordCategory;
        document.getElementById('max-rounds').value = config.maxRounds;
        document.getElementById('vote-time').value = config.voteTime;
        updatePlayerInputs();
      } catch (e) {
        localStorage.removeItem(STORAGE_KEY);
      }
    }

    // Actualizar inputs de jugadores conservando valores existentes
    function updatePlayerInputs() {
      const count = parseInt(document.getElementById('player-count').value);
      const container = document.getElementById('player-names-container');
      
      const existingValues = [];
      const existingInputs = container.querySelectorAll('input');
      existingInputs.forEach(input => {
        existingValues.push(input.value);
      });
      
      container.innerHTML = '';
      
      for (let i = 0; i < count; i++) {
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = `Jugador ${i + 1}`;
        input.id = `player-${i}`;
        if (i < existingValues.length) {
          input.value = existingValues[i];
        }
        container.appendChild(input);
      }
    }

    // Iniciar juego
    function startGame(event) {
      event.preventDefault();
      
      const playerCount = parseInt(document.getElementById('player-count').value);
      gameState.players = [];
      
      for (let i = 0; i < playerCount; i++) {
        const name = document.getElementById(`player-${i}`).value.trim() || `Jugador ${i + 1}`;
        gameState.players.push(name);
      }
      
      gameState.impostorCount = parseInt(document.getElementById('impostor-count').value);
      gameState.wordCategory = document.getElementById('word-category').value;
      gameState.maxRounds = parseInt(document.getElementById('max-rounds').value);
      gameState.voteTime = parseInt(document.getElementById('vote-time').value);
      gameState.eliminated = [];
      gameState.currentRound = 0;
      
      gameState.initialFirstPlayer = Math.floor(Math.random() * gameState.players.length);
      gameState.firstPlayerIndex = gameState.initialFirstPlayer;
      
      saveConfig();
      startNewRound();
    }

    // Iniciar nueva ronda
    function startNewRound() {
      gameState.currentRound++;
      updateRoundIndicators();
      assignRoles();
      gameState.currentPlayerIndex = 0;
      showPassPhoneScreen();
    }

    // Asignar roles y palabra
    function assignRoles() {
      let categoryToUse = gameState.wordCategory;
      
      if (gameState.wordCategory === 'aleatoria') {
        const categories = Object.keys(wordBank);
        categoryToUse = categories[Math.floor(Math.random() * categories.length)];
        gameState.currentCategory = categoryToUse;
      } else {
        gameState.currentCategory = gameState.wordCategory;
      }
      
      const words = wordBank[categoryToUse];
      gameState.word = words[Math.floor(Math.random() * words.length)];
      
      const activeIndexes = gameState.players
        .map((p, i) => i)
        .filter(i => !gameState.eliminated.includes(i));
      
      gameState.roles = new Array(gameState.players.length).fill('citizen');
      gameState.impostorIndexes = [];
      
      const shuffled = [...activeIndexes].sort(() => Math.random() - 0.5);
      const impostorCount = Math.min(gameState.impostorCount, activeIndexes.length - 1);
      
      for (let i = 0; i < impostorCount; i++) {
        const idx = shuffled[i];
        gameState.roles[idx] = 'impostor';
        gameState.impostorIndexes.push(idx);
      }
    }

    // Mostrar pantalla de pasar celular
    function showPassPhoneScreen() {
      if (gameState.currentPlayerIndex >= gameState.players.length) {
        showStartCluesScreen();
        return;
      }
      
      if (gameState.eliminated.includes(gameState.currentPlayerIndex)) {
        gameState.currentPlayerIndex++;
        showPassPhoneScreen();
        return;
      }
      
      const playerName = gameState.players[gameState.currentPlayerIndex];
      document.getElementById('pass-phone-text').textContent = `Pasá el celular a ${playerName}`;
      showScreen('screen-pass-phone');
    }

    // Mostrar palabra
    function showWord() {
      const role = gameState.roles[gameState.currentPlayerIndex];
      const wordCard = document.getElementById('word-card');
      const wordDisplay = document.getElementById('word-display');
      const wordHeader = document.getElementById('word-header');
      
      if (role === 'impostor') {
        wordCard.classList.add('impostor');
        wordDisplay.className = 'secret-word impostor';
        wordDisplay.textContent = 'IMPOSTOR';
        wordHeader.textContent = 'Tu Rol';
      } else {
        wordCard.classList.remove('impostor');
        wordDisplay.className = 'secret-word';
        wordDisplay.textContent = gameState.word;
        wordHeader.textContent = 'Tu Palabra';
      }
      
      showScreen('screen-show-word');
    }

    // Siguiente jugador
    function nextPlayerWord() {
      gameState.currentPlayerIndex++;
      showPassPhoneScreen();
    }

    // Mostrar pantalla de inicio de pistas
    function showStartCluesScreen() {
      if (!gameState.eliminated.includes(gameState.initialFirstPlayer)) {
        gameState.firstPlayerIndex = gameState.initialFirstPlayer;
      } else {
        let nextIndex = (gameState.initialFirstPlayer + 1) % gameState.players.length;
        while (gameState.eliminated.includes(nextIndex)) {
          nextIndex = (nextIndex + 1) % gameState.players.length;
        }
        gameState.firstPlayerIndex = nextIndex;
        gameState.initialFirstPlayer = nextIndex;
      }
      
      const categoryNames = {
        'deportes': 'Deportes',
        'peliculasSeries': 'Películas y Series',
        'objetos': 'Objetos',
        'lugares': 'Lugares',
        'personalidades': 'Personalidades',
        'cocina': 'Cocina',
        'animales': 'Animales',
        'musica': 'Música',
        'tecnologia': 'Tecnología'
      };
      
      document.getElementById('first-player-name').textContent = gameState.players[gameState.firstPlayerIndex];
      document.getElementById('category-display').textContent = categoryNames[gameState.currentCategory] || gameState.currentCategory;
      showScreen('screen-start-clues');
    }

    // Iniciar seguimiento de pistas
    function startClueTracking() {
      gameState.currentClueIndex = gameState.firstPlayerIndex;
      updateClueScreen();
      showScreen('screen-clues');
    }

    // Actualizar pantalla de pistas
    function updateClueScreen() {
      document.getElementById('current-clue-player').textContent = gameState.players[gameState.currentClueIndex];
      
      const list = document.getElementById('clue-player-list');
      list.innerHTML = '';
      
      gameState.players.forEach((player, idx) => {
        if (gameState.eliminated.includes(idx)) return;
        
        const item = document.createElement('div');
        item.className = 'player-item';
        if (idx === gameState.currentClueIndex) {
          item.classList.add('active');
        }
        item.innerHTML = `
          <span class="player-name">${player}</span>
          <span style="color:var(--muted);">${idx === gameState.currentClueIndex ? '← Turno actual' : ''}</span>
        `;
        list.appendChild(item);
      });
    }

    // Siguiente pista
    function nextClue() {
      const startIndex = gameState.currentClueIndex;
      
      do {
        gameState.currentClueIndex = (gameState.currentClueIndex + 1) % gameState.players.length;
      } while (gameState.eliminated.includes(gameState.currentClueIndex));
      
      if (gameState.currentClueIndex === gameState.firstPlayerIndex) {
        startVoteTimer();
      } else {
        updateClueScreen();
      }
    }

    // Iniciar timer de votación
    function startVoteTimer() {
      let timeLeft = gameState.voteTime;
      const timerEl = document.getElementById('vote-timer');
      
      const mins = Math.floor(timeLeft / 60);
      const secs = timeLeft % 60;
      timerEl.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      
      showScreen('screen-vote-timer');
      
      if (voteTimer) clearInterval(voteTimer);
      
      voteTimer = setInterval(() => {
        timeLeft--;
        const mins = Math.floor(timeLeft / 60);
        const secs = timeLeft % 60;
        timerEl.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        
        if (timeLeft <= 0) {
          clearInterval(voteTimer);
          showVoteScreen();
        }
      }, 1000);
    }

    // Saltar a votación
    function skipToVote() {
      if (voteTimer) clearInterval(voteTimer);
      showVoteScreen();
    }

    // Mostrar pantalla de votación
    function showVoteScreen() {
      const container = document.getElementById('vote-buttons');
      container.innerHTML = '';
      
      gameState.players.forEach((player, idx) => {
        if (gameState.eliminated.includes(idx)) return;
        
        const btn = document.createElement('button');
        btn.className = 'vote-btn';
        btn.textContent = player;
        btn.onclick = () => eliminatePlayer(idx);
        container.appendChild(btn);
      });
      
      showScreen('screen-vote');
    }

    // Eliminar jugador
    function eliminatePlayer(idx) {
      gameState.eliminated.push(idx);
      const role = gameState.roles[idx];
      const playerName = gameState.players[idx];
      
      const resultBox = document.getElementById('result-box');
      document.getElementById('eliminated-player-name').textContent = playerName;
      const roleEl = document.getElementById('eliminated-player-role');
      
      if (role === 'impostor') {
        roleEl.textContent = 'IMPOSTOR';
        roleEl.className = 'role-text impostor';
        resultBox.classList.add('impostor');
      } else {
        roleEl.textContent = 'CIUDADANO';
        roleEl.className = 'role-text citizen';
        resultBox.classList.remove('impostor');
      }
      
      checkGameEnd();
    }

    // Verificar fin de juego
    function checkGameEnd() {
      const activeImpostors = gameState.impostorIndexes.filter(i => !gameState.eliminated.includes(i));
      const activePlayers = gameState.players.filter((p, i) => !gameState.eliminated.includes(i));
      
      const statusText = document.getElementById('game-status-text');
      const buttons = document.getElementById('result-buttons');
      buttons.innerHTML = '';
      
      if (activeImpostors.length === 0) {
        statusText.textContent = '¡Todos los impostores fueron eliminados!';
        const btn = document.createElement('button');
        btn.className = 'btn btn-primary';
        btn.textContent = 'Ver resultado final';
        btn.onclick = () => endRound('citizens');
        buttons.appendChild(btn);
      } else if (gameState.currentRound >= gameState.maxRounds) {
        statusText.textContent = `Se alcanzó el máximo de rondas (${gameState.maxRounds})`;
        const btn = document.createElement('button');
        btn.className = 'btn btn-primary';
        btn.textContent = 'Ver resultado final';
        btn.onclick = () => endRound('impostors');
        buttons.appendChild(btn);
      } else if (activePlayers.length <= activeImpostors.length * 2) {
        statusText.textContent = '¡Los impostores tienen ventaja!';
        const btn = document.createElement('button');
        btn.className = 'btn btn-primary';
        btn.textContent = 'Ver resultado final';
        btn.onclick = () => endRound('impostors');
        buttons.appendChild(btn);
      } else {
        statusText.textContent = `Quedan ${activeImpostors.length} impostor(es) activos. Ronda ${gameState.currentRound + 1} de ${gameState.maxRounds}`;
        const btn = document.createElement('button');
        btn.className = 'btn btn-primary';
        btn.textContent = 'Siguiente ronda';
        btn.onclick = startNewRound;
        buttons.appendChild(btn);
      }
      
      showScreen('screen-vote-result');
    }

    // Terminar ronda
    function endRound(winner) {
      const winnerText = document.getElementById('round-winner-text');
      const summaryText = document.getElementById('round-summary');
      
      if (winner === 'citizens') {
        winnerText.textContent = '¡Ganaron los Ciudadanos!';
        summaryText.textContent = 'Todos los impostores fueron eliminados.';
      } else {
        winnerText.textContent = '¡Ganaron los Impostores!';
        summaryText.textContent = 'Los impostores lograron sobrevivir.';
      }
      
      showScreen('screen-end-round');
    }

    // Mostrar opciones para jugar de nuevo
    function showPlayAgainOptions() {
      showScreen('screen-play-again');
    }

    // Repetir todo igual
    function repeatAll() {
      gameState.eliminated = [];
      gameState.currentRound = 0;
      gameState.initialFirstPlayer = Math.floor(Math.random() * gameState.players.length);
      gameState.firstPlayerIndex = gameState.initialFirstPlayer;
      startNewRound();
    }

    // Cambiar solo categoría
    function changeCategory() {
      const categories = ['aleatoria', 'deportes', 'peliculasSeries', 'objetos', 'lugares', 'personalidades', 'cocina', 'animales', 'musica', 'tecnologia'];
      const currentIndex = categories.indexOf(gameState.wordCategory);
      const nextIndex = (currentIndex + 1) % categories.length;
      gameState.wordCategory = categories[nextIndex];
      
      document.getElementById('word-category').value = gameState.wordCategory;
      saveConfig();
      
      repeatAll();
    }

    // Cambiar configuración
    function changeConfig() {
      showScreen('screen-setup');
    }

    // Inicialización
    document.addEventListener('DOMContentLoaded', () => {
      loadConfig();
      updatePlayerInputs();
    });
  </script>
</body>
</html>
